
Imports System.Data.OleDb

'overall the main issue i'm having is the library imported above when I try to use it then program outputs a message saying it is not usable as the library is not imported
'in terms of what I need the database to do I need it to open the table and execute a query this is a MUST. Getting the program to write to the database is just added functionality
Public Class Form1
    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click

        startProgram()
    End Sub
    Structure userInformation

        Dim id As String
        Dim username As String
        Dim password As String
        Dim level As String

    End Structure

    Sub startProgram()

        Dim user As userInformation
        Dim allUsers(9) As userInformation
        Dim optionInputted As String = ""
        Dim tempUsername As String
        Dim tempPassword As String
        Dim tempId As String = "0"
        Dim loginCreate As Integer = 0
        Dim login As Boolean
        Dim verifyLoginDetails As Boolean
        Dim max As Integer

        While login <> True
            optionInputted = InputBox("login or create")
            If optionInputted = "login" Then
                loginCreate = 1
                'inputAccountInfo(tempPassword, tempUsername, loginCreate) 'this is where the user inputs the password and username and the program verifies they are both 8 characters
                'dataBaseConnection(allUsers)
                bubbleSort(allUsers) 'for examination purposes I need to use an algorithm such as binary search or bubble sort to filter through the data
                'verifyLogin(allUsers, tempPassword, tempUsername, verifyLoginDetails) 'this is the method that checks the 10 accounts imported in from the database and compares them to what the user has inputted as their password and username in the login process
                'login = True 'this stops the loop when logged in as the game can only be played with the user logged in
                'homeScreen(user, allUsers) 'this is where the user selects the level they want to continue from
            ElseIf optionInputted = "create" Then
                loginCreate = 2
                inputAccountInfo(tempPassword, tempUsername, loginCreate)
                'here I need to open the connection and write the username and password the user has created
                dataBaseConnection(allUsers)
                findHighestId(allUsers, max)
                user.id = max + 1
                user.username = tempUsername
                user.password = tempPassword
                user.level = 0
                login = True
                homeScreen(user, allUsers)
            Else
                MsgBox("error please enter 'login' to login to your account or enter 'create' to create an account")
            End If

        End While

    End Sub
    Sub findHighestId(ByVal users() As userInformation, ByRef max As Integer)

        For x As Integer = 0 To 9 Step 1
            If users(x).id > max Then
                max = users(x).id
            End If
        Next

    End Sub
    Sub inputAccountInfo(ByRef Password As String, ByRef Username As String, ByRef x As Integer)

        Dim sign As Boolean ' variable to keep loop if username and password is not 8 characters
        Dim characterCount1 As Integer
        Dim characterCount2 As Integer

        While sign <> True

            Username = InputBox("please enter your username")
            Password = InputBox("please enter your password")
            characterCount1 = Len(Password)
            characterCount2 = Len(Username)
            If characterCount1 = 8 And characterCount2 = 8 Then
                sign = True
                MsgBox("password and username is 8 characters")
            ElseIf characterCount1 <> 8 And characterCount2 <> 8 Then
                sign = False
                MsgBox("error password or username is not 8 characters long")
            Else
                MsgBox("error")
            End If
        End While

    End Sub
    Sub homeScreen(ByRef user As userInformation, ByVal allUsers() As userInformation)

        Dim desiredLevel As String
        Dim userInput1 As String
        Dim x As Boolean = False

        userInput1 = InputBox("would you like to select a level or play from the start")

        While x <> True
            If userInput1 = "select" Then
                desiredLevel = InputBox("which level would you like to continue from?")
                If desiredLevel = "1" Then
                    level1(user, allUsers)
                    x = True
                ElseIf desiredLevel = "2" Then
                    If user.level >= 2 Then
                        level2(user, allUsers)
                        x = True
                    ElseIf user.level < 2 Then
                        MsgBox("you have not unlocked that level yet")
                    Else
                        MsgBox("error")
                    End If
                ElseIf desiredLevel = "3" Then
                    If user.level >= 3 Then
                        level3(user, allUsers)
                        x = True
                    ElseIf user.level < 3 Then
                        MsgBox("you haven't unlocked that level yet")
                    Else
                        MsgBox("error")
                    End If
                ElseIf desiredLevel > 3 Or desiredLevel < 1 Then
                    MsgBox("there's only 3 levels")
                End If
            ElseIf userInput1 = "start" Then
                level1(user, allUsers)
            Else
                MsgBox("error")
                x = True
            End If
        End While

    End Sub

    Sub verifyLogin(ByVal users() As userInformation, ByVal userPassword As String, ByVal userUsername As String, ByRef loginVerified As Boolean)

        For x As Integer = 0 To 9 Step 1
            If users(x).username = userUsername And users(x).password = userPassword Then
                loginVerified = True
            End If
        Next

        If loginVerified = True Then
            MsgBox("login was verified!")
        ElseIf loginVerified = False Then
            MsgBox("login was not verified please enter your username and password again")
        End If

    End Sub


    Sub bubbleSort(ByRef users() As userInformation)

        Dim swaps As Boolean = True
        Dim outer As Integer = 8
        Dim placeHolder As userInformation

        users(0).level = "28"
        users(1).level = "12"
        users(2).level = "90"
        users(3).level = "34"
        users(4).level = "59"
        users(5).level = "0"
        users(6).level = "2"
        users(7).level = "8"
        users(8).level = "27"
        users(9).level = "14"

        While swaps = True And outer >= 0
            swaps = False
            For inner = 0 To outer
                If users(inner).level > users(inner + 1).level Then
                    placeHolder = users(inner + 1)
                    users(inner + 1) = users(inner)
                    users(inner) = placeHolder
                    swaps = True
                End If
            Next
            outer = outer - 1
        End While

        For x As Integer = 0 To 9 Step 1
            MsgBox(users(x).level)
        Next

    End Sub

    Sub dataBaseConnection(ByRef users() As userInformation)

        Dim i As Integer = 0

        Try
            'connection to the database executing the query and reading in the data
            Dim SQLReader As OleDbDataReader
            Dim connection_type As String = "Provider=Microsoft.ACE.OLEDB.12.0;"
            Dim file_location As String = "Data Source=C:\Users\sahil\Desktop\Adv H Quiz\userInformationDatabase.accdb"
            Dim conn As OleDbConnection
            conn = New OleDbConnection(connection_type & file_location)
            conn.Open()
            'example 1 - select and display results()
            Dim query As String = "SELECT * FROM [userInformation]"
            Dim command As New OleDbCommand(query, conn)
            SQLReader = command.ExecuteReader

            If SQLReader.HasRows Then
                While SQLReader.Read
                    users(i).id = SQLReader("User ID")
                    users(i).username = SQLReader("Username")
                    users(i).password = ("Password")
                    users(i).level = SQLReader("Level")
                    i = i + 1
                End While
            Else
                MsgBox("no results returned")
            End If

        Catch ex As Exception
            MsgBox(ex.Message)
        End Try

    End Sub

    Sub level1(ByRef user As userInformation, ByVal users() As userInformation)

        Dim userAnswer As String
        Dim levelComplete As Boolean
        Dim [continue] As String
        While levelComplete <> True
            userAnswer = InputBox("what is 2+2?")
            If userAnswer = "4" Then
                levelComplete = True
                MsgBox("correct!")
                If user.level < 1 Then
                    user.level = 1
                End If
            ElseIf userAnswer <> "4" Then
                levelComplete = False
                MsgBox("incorrect")
            Else
                MsgBox("error")
            End If
        End While

        [continue] = InputBox("would you like to continue?")
        If [continue] = "yes" Then
            level2(user, users)
        ElseIf [continue] = "no" Then
            homeScreen(user, users)
        Else
            MsgBox("error")
            homeScreen(user, users)
        End If

    End Sub

    Sub level2(ByRef user As userInformation, ByVal users() As userInformation)

        Dim userAnswer As String
        Dim levelComplete As Boolean
        Dim [continue] As String
        While levelComplete <> True
            userAnswer = InputBox("what is 4+4?")
            If userAnswer = "8" Then
                levelComplete = True
                MsgBox("correct!")
                If user.level < 2 Then
                    user.level = 2
                End If
            ElseIf userAnswer <> "8" Then
                levelComplete = False
                MsgBox("incorrect")
            Else
                MsgBox("error")
            End If
        End While

        [continue] = InputBox("would you like to continue?")
        If [continue] = "yes" Then
            level3(user, users)
        ElseIf [continue] = "no" Then
            homeScreen(user, users)
        Else
            MsgBox("error")
            homeScreen(user, users)
        End If

    End Sub

    Sub level3(ByRef user As userInformation, ByVal users() As userInformation)

        Dim userAnswer As String
        Dim levelComplete As Boolean
        Dim [continue] As String
        While levelComplete <> True
            userAnswer = InputBox("what is 6+6?")
            If userAnswer = "12" Then
                levelComplete = True
                MsgBox("correct!")
                If user.level < 3 Then
                    user.level = 3
                End If
            ElseIf userAnswer <> "12" Then
                levelComplete = False
                MsgBox("incorrect")
            Else
                MsgBox("error")
            End If
        End While

        MsgBox("You have completed the game! the program will now restart you can continue from any level")

    End Sub

End Class
